# Ja16文字セット仕様定義 (Ja16 Character Set Specification)

## 0. プロジェクトの背景と目的 (Background and Purpose)
既存の文字セット（Unicode, Shift-JIS等）が抱える構造的・文化的課題を解決し、日本語開発者が高い計算効率と「一字一符号」の確実性を持って扱える計算機環境を構築する。

### 0.1 Ja16の独自価値 (Unique Value Proposition of Ja16)
1. **決定論的構造 (Deterministic Structure):** サロゲートペアや結合文字を徹底排除した「完全2バイト固定長」を実現。文字処理の複雑性を1/10以下にし、計算量を O(1) に低減する。
2. **日本文化・技術文書への特化 (Cultural & Technical Optimization):** 統合漢字により分散したMJ文字（日本行政・人名の基盤）を主軸に再構築。同時に、日本のAA文化と現代技術文書に必要な記号を連続した空間に最適配置する。
3. **バイナリ・テキスト透過性 (Binary-Text Transparency):** 0x00(NULL)の排除と全スロット可視化（Base65536対応）により、あらゆるバイナリデータを「人間が読める等幅テキスト」として損失なく表現可能にする。Base16/36/62/64演算との親和性は他規格に存在しない。

### 0.2 既存文字セットとの比較優位性 (Comparison with Existing Sets)
| 項目 | UTF-8 | UTF-16 | UTF-32 | **Ja16** |
| :--- | :--- | :--- | :--- | :--- |
| **データ長** | 可変 (1-4B) | 可変 (2or4B) | 固定 (4B) | **固定 (2B)** |
| **ランダムアクセス** | 不可 (O(n)) | 不可 (O(n)) | 可能 (O(1)) | **可能 (O(1))** |
| **メモリ効率** | ASCII優秀/日本語劣 | 漢字良好 | 最悪 | **日本語/技術書に最適** |
| **正規化 (NFC/NFD)** | 必須（複雑） | 必須（複雑） | 必須（複雑） | **不要（一字一符号）** |
| **バイナリ/テキスト透過性**| なし | なし | なし | **あり (Base65536可視化)** |

- **vs Unicode:** サロゲートペアや結合文字を廃し、完全固定長と「一字一符号」を実現。
- **vs Shift-JIS:** 独自バイナリ構造により「ダメ文字問題（0x5C混入）」を物理的に根絶。
- **vs EUC-JP:** 3バイト文字やステート管理を排除。MJ文字（5.8万字）収録による表現力確保。
- **vs TRONコード:** 言語プレフィックスを排除した「フラットな単一空間」。

### 0.3 結論：なぜ今、Ja16を作るのか？ (Why now?)
「汎用性の呪縛（Unicode）」から日本語開発者を解放し、計算機・人間・データのすべてに最適なバランスを提供する。
- **計算機への優しさ:** O(1) アクセス、正規化不要、バイナリ/テキスト一致。
- **人間への優しさ:** MJ文字による完全表現、AA文化の継承、技術書への最適化。
- **データへの優しさ:** どんなバイナリも損失なく可視化し、BaseX変換効率を最大化する。

---

## 1. 要件定義 (Requirements Definition)

### 1.1 構造的要件 (Structural Requirements)
1. **2バイト固定長の厳守:** 文字境界判定を不要とし、O(1) のランダムアクセスを保証する。
2. **ASCII互換性の排除:** 独自マッピングにより「ダメ文字問題」を物理的に解決する。
3. **NULL(0x00)の排除:** 全スロットをデータとして活用し、ヌル終端に依存しないパースを行う。
4. **エンディアンの固定:** Big-Endianに固定する。

### 1.2 開発効率・計算効率要件 (Efficiency Requirements)
1. **ソートの一致:** 16進数文字列ソートと、バイナリ値ソートを完全に一致させる。
2. **BaseX親和性:** Base10, 16, 36, 62, 64(URL)の英数字を最優先配置し、変換効率を高める。
3. **全字可視化:** どんなバイナリ値も表示可能なグリフ（点字等）を持ち、可視化デバッグを可能にする。

### 1.3 表現力要件 (Expressive Requirements)
1. **日本語表現の完遂:** IPA文字情報基盤（MJ文字）を全収録し、人名・地名・古語を網羅する。
2. **技術文書・プログラミング対応:** 数学、論理学、手順書（囲み文字）、UI/HW解説（電源記号等）に必要な記号を網羅する。
3. **AAの完全再現:** 日本のAA文化に不可欠な特殊文字（タイ文字、拡張キリル、Block Elements等）を網羅する。

---

## 2. 仕様定義 (Specification Definition)

### 2.1 アドレスマップ（全体像） (Address Map Overview)
| アドレス範囲 | スロット数 | 内容カテゴリ | 根拠要件 |
| :--- | :--- | :--- | :--- |
| **0x0000 〜 0x0060** | **97** | **ASCII抜粋領域** | BaseX親和性、ソート一致 |
| **0x0061 〜 0x1A11** | **6,577** | **非漢字・拡張領域** | 日本語、技術記号、AA、点字 |
| **0x1A12 〜 0xFFFF** | **58,862** | **IPA漢字領域** | 日本語表現の完遂（MJ文字） |

### 2.2 ASCII抜粋領域 (0x0000 〜 0x0060 / 97スロット)
**【順序確定】**
1. 0x0000-0x0009: `0 1 2 3 4 5 6 7 8 9` (数値と一致)
2. 0x000A-0x000F: `A B C D E F` (Base16アルファベット)
3. 0x0010-0x0023: `G H I J K L M N O P Q R S T U V W X Y Z` (大文字)
4. 0x0024-0x003D: `a b c d e f g h i j k l m n o p q r s t u v w x y z` (小文字)
5. 0x003E-0x003F: `_ -` (Base64URL。アンダースコア優先)
6. 0x0040-0x005D: `! " # $ % & ' ( ) * + , . / : ; < = > ? @ [ \ ] ^ ` { | } ~` (記号)
7. 0x005E-0x0060: `HT, LF, SP` (制御文字。ASCII順)

### 2.3.1 非漢字・拡張領域の網羅性保証 (Coverage Assurance: Non-Kanji)
本領域（6,577スロット）の網羅性は、以下の公式ソースおよび手順により、客観的に保証する。

| 対象カテゴリ | 検証用リファレンス | 検証手順・具体的エビデンス |
| :--- | :--- | :--- |
| 1. 日本語表現(非漢字) | JIS X 0213:2004 非漢字 | URL: https://ja.wikipedia.org/wiki/JIS_X_0213非漢字一覧<br>手順: 表中の「符号(Unicode)」列にある1,130字がJa16に全数収録されていることを確認。 |
| 2. AA・顔文字 | AAHub 掲載フォントデータ | URL: https://github.com/AAHub/fontbook/tree/master/src/assets/fonts<br>手順: リストより Saitamaar.ttf または Textar.ttf を入手。フォントビューアで開き、タイ文字(U+0E00-)、拡張キリル(U+0400-)、古イタリア文字(U+10300-)等のAAパーツが定義されていることを確認。 |
| 3. 数学・論理 | Unicode Math Charts | URL: https://www.unicode.org/charts/PDF/U2200.pdf<br>手順: Mathematical Operators (U+2200-22FF) のPDFチャート全図形が収録されていることを確認。 |
| 4. 手順書・UI | Unicode Tech Charts | URL: https://www.unicode.org/charts/PDF/U2300.pdf<br>手順: Miscellaneous Technical (U+2300-23FF) のPDFチャート全図形が収録されていることを確認。 |
| 5. 囲み文字 | Unicode Enclosed Charts | URL: https://www.unicode.org/charts/PDF/U2460.pdf<br>手順: Enclosed Alphanumerics (U+2460-24FF) のPDFチャート全図形が収録されていることを確認。 |

### 2.4.1 IPA漢字領域の網羅性保証 (Coverage Assurance: IPA Kanji)
| 対象カテゴリ | 検証用ソース | 具体的検証手順 |
| :--- | :--- | :--- |
| 日本語表現(漢字) | IPA 文字情報基盤 (MJ文字) | URL: https://moji.or.jp/mojikiban/mj/mjlist/<br>手順: 同サイトから mji.00602.xlsx をダウンロード。ファイル内の「MJ文字図形名（MJ000001〜MJ058862）」がJa16のインデックス（0x1A12以降）と完全一致することを確認する。 |

---

## 3. プロジェクト運用プロトコル (Operational Protocol)

### 3.1 一字一符号の原則 (One Character, One Code Principle)
文字と符号を1対1で対応させ、結合文字を徹底的に排除する。

### 3.2 要約・省略の禁止 (Prohibition of Summary/Omission)
確定済みの順序、存在意義、検証用ソース等の情報を「要約」として削減することを厳禁とする。

### 3.3 変更承認制 (Change Approval Protocol)
既存の全記述（存在意義、要件、仕様）の変更・削除には、必ず理由を添えた提案(RFC)と承認を必須とする。

### 3.4 セマンティック・アンカーの維持 (Maintenance of Semantic Anchors)
AIの解釈精度維持のため英語併記を継続する。

### 3.5 厳密な変更管理ワークフロー (Strict Change Management Workflow)
AIはこのプロトコルを最優先の行動原理とし、以下のステップを遵守すること。

- **STEP 1 [議論]**: 課題に対し、AIとユーザーで問答を繰り返す。
- **STEP 2 [合意]**: 変更の必要性を双方が認める。
- **STEP 3 [RFC提示]**: AIは変更箇所「のみ」を抜き出し提示する。
  - **【禁止事項】**: 変更に関係のないセクションや既存テキストを出力に含めてはならない。
  - **【必須項目】**: 1.対象箇所(見出し番号)、2.方針(追記/削除/修正)、3.具体的テキスト内容、4.根拠。
  - **【制約報告】**: AIの制約（ハルシネーション/トークン制限）により指示の実行が困難な場合は、この時点で「何が、なぜ、できないか」を正直に報告すること。
- **STEP 4 [ユーザー精査]**: ユーザーがRFCを確認。問題があればSTEP 1に戻る。
- **STEP 5 [反映宣言]**: ユーザーが承認後、AIは内部状態（マスタードキュメント）を更新する。
- **STEP 6 [全文確認(Text)]**: 全文を提示する。
  - **【警告】**: 既存の未変更箇所を1文字でも要約・改変してはならない。完全なコピーを出力せよ。
- **STEP 7 [最終承認]**: ユーザーが全文を確認し、最終承認を下す。
- **STEP 8 [エクスポート(Markdown)]**: 承認後、全文を「Markdown形式(コードブロック)」で提示する。
- ※注意: ステップを飛ばすこと、および「親切心」による無断の全文提示はプロジェクト破綻の最大要因である。提案時は差分のみに集中せよ。

### 3.6 環境構築要件 (Environment Setup Requirements) - ※人間用
本プロジェクトの引き継ぎ・再開時には、以下の設定を完遂すること。
1. **Temperature (温度)**: `0` に設定。
2. **モデル**: Pro系最新モデル（Gemini 2.5 Pro等）を選択。
3. **System Instructions**: 上記の **3.1から3.5まで** の内容を貼り付ける。
4. **開始コマンド**: 最初に「引き継ぎ用絶対命令ヘッダー」を投稿し、AIの自己申告を確認する。
