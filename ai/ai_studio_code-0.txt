# Ja16文字セット仕様定義 (Ja16 Character Set Specification)

## 0. プロジェクトの背景と目的 (Background and Purpose)
既存の文字セット（Unicode, Shift-JIS等）が抱える構造的・文化的課題を解決し、日本語開発者が高い計算効率と「一字一符号」の確実性を持って扱える計算機環境を構築する。

### 0.1 Ja16の独自価値 (Unique Value Proposition of Ja16)
1. **決定論的構造 (Deterministic Structure):**
   サロゲートペアや結合文字を徹底排除した「完全2バイト固定長」を実現。文字処理の複雑性を1/10以下にし、計算量を O(1) に低減する。
2. **日本文化・技術文書への特化 (Cultural & Technical Optimization):**
   他国語と統合され分散したMJ文字（日本行政・人名の基盤）を主軸に再構築。同時に、日本のAA文化と現代技術文書に必要な記号を連続した空間に最適配置する。
3. **バイナリ・テキスト透過性 (Binary-Text Transparency):**
   0x00(NULL)の排除と全スロット可視化（Base65536対応）により、あらゆるバイナリデータを「人間が読める等幅テキスト」として損失なく表現可能にする。Base16/36/62/64演算との親和性は他規格に存在しない。

### 0.2 既存文字セットとの比較優位性 (Comparison with Existing Sets)
| 項目 | UTF-8 | UTF-16 | UTF-32 | **Ja16** |
| :--- | :--- | :--- | :--- | :--- |
| **データ長** | 可変 (1-4B) | 可変 (2or4B) | 固定 (4B) | **固定 (2B)** |
| **ランダムアクセス** | 不可 (O(n)) | 不可 (O(n)) | 可能 (O(1)) | **可能 (O(1))** |
| **メモリ効率** | ASCII優秀/日本語劣 | 漢字良好 | 最悪 | **日本語/技術書に最適** |
| **正規化 (NFC/NFD)** | 必須（複雑） | 必須（複雑） | 必須（複雑） | **不要（一字一符号）** |
| **バイナリ/テキスト透過性**| なし | なし | なし | **あり (Base65536可視化)** |

- **vs Unicode:** サロゲートペアや結合文字を廃し、完全固定長と「一字一符号」を実現。
- **vs Shift-JIS:** 独自バイナリ構造により「ダメ文字問題（0x5C混入）」を物理的に根絶。
- **vs EUC-JP:** 3バイト文字や複雑なステート管理、MJ文字（5.8万字）を収録できない表現力不足を解決。
- **vs TRONコード:** 言語プレフィックスによる切り替えを排除した「フラットな単一空間」。

### 0.3 結論：なぜ今、Ja16を作るのか？ (Why now?)
「汎用性の呪縛（Unicode）」から日本語開発者を解放し、計算機・人間・データのすべてに最適なバランスを提供する。
- **計算機への優しさ:** O(1) アクセス、正規化不要、バイナリ/テキスト一致。
- **人間への優しさ:** MJ文字による完全表現、AA文化の継承、技術書への最適化。
- **データへの優しさ:** どんなバイナリも損失なく可視化し、BaseX変換効率を最大化する。

---

## 1. 要件定義 (Requirements Definition)

### 1.1 構造적 要件 (Structural Requirements)
1. **2バイト固定長の厳守:** 文字境界判定を不要とし、O(1) のランダムアクセスを保証する。
2. **ASCII互換性の排除:** 独自マッピングにより「ダメ文字問題」を物理的に解決する。
3. **NULL(0x00)の排除:** 全スロットをデータとして活用し、ヌル終端に依存しないパースを行う。
4. **エンディアンの固定:** Big-Endianに固定する。

### 1.2 開発効率・計算効率要件 (Efficiency Requirements)
1. **ソートの一致:** 16進数文字列ソートと、バイナリ値ソートを完全に一致させる。
2. **BaseX親和性:** Base10, 16, 36, 62, 64(URL)の英数字を最優先配置し、変換効率を高める。
3. **全字可視化:** どんなバイナリ値も表示可能なグリフ（点字等）を持ち、可視化デバッグを可能にする。

### 1.3 表現力要件 (Expressive Requirements)
1. **日本語表現の完遂:** IPA文字情報基盤（MJ文字）を全収録し、人名・地名・古語を網羅する。
2. **技術文書・プログラミング対応:** 数学、論理学、手順書（囲み文字）、UI/HW解説（電源記号等）に必要な記号を網羅する。
3. **AAの完全再現:** 日本のAA文化に不可欠な特殊文字（タイ文字、拡張キリル、Block Elements等）を網羅する。

---

## 2. 仕様定義 (Specification Definition)

### 2.1 アドレスマップ（全体像） (Address Map Overview)
| アドレス範囲 | スロット数 | 内容カテゴリ | 根拠要件 |
| :--- | :--- | :--- | :--- |
| **0x0000 〜 0x0060** | **97** | **ASCII抜粋領域** | BaseX親和性、ソート一致 |
| **0x0061 〜 0x1A11** | **6,577** | **非漢字・拡張領域** | 日本語、技術記号、AA、点字 |
| **0x1A12 〜 0xFFFF** | **58,862** | **IPA漢字領域** | 日本語表現の完遂（MJ文字） |

### 2.2 ASCII抜粋領域 (0x0000 〜 0x0060 / 97スロット)
**【順序確定】**
1. 0x0000-0x0009: `0 1 2 3 4 5 6 7 8 9` (数値と一致)
2. 0x000A-0x000F: `A B C D E F` (Base16アルファベット)
3. 0x0010-0x0023: `G H I J K L M N O P Q R S T U V W X Y Z` (大文字)
4. 0x0024-0x003D: `a b c d e f g h i j k l m n o p q r s t u v w x y z` (小文字)
5. 0x003E-0x003F: `_ -` (Base64URL。アンダースコア優先)
6. 0x0040-0x005D: `! " # $ % & ' ( ) * + , . / : ; < = > ? @ [ \ ] ^ ` { | } ~` (記号)
7. 0x005E-0x0060: `HT, LF, SP` (制御文字。ASCII順)

### 2.3.1 非漢字・拡張領域の網羅性保証 (Coverage Assurance: Non-Kanji)
本領域（6,577スロット）の網羅性は、以下の公式ソースに含まれる全文字をマッピングすることで客観的に保証する。

| 対象カテゴリ | 検証用ソース（規格名・フォント名） | 公式URL / 検証手順・具体的エビデンス |
| :--- | :--- | :--- |
| **1. 日本語表現(非漢字)** | **JIS X 0213:2004 非漢字** | **URL:** [https://ja.wikipedia.org/wiki/JIS_X_0213非漢字一覧](https://ja.wikipedia.org/wiki/JIS_X_0213%E9%9D%9E%E6%BC%A2%E5%AD%97%E4%B8%80%E8%A6%A7)<br>**手順:** 表中の「符号(Unicode)」列にある1,130字がJa16に全数収録されていることを目視確認する。 |
| **2. AA・顔文字** | **AAHub 掲載フォントデータ** | **URL:** [https://github.com/AAHub/fontbook/tree/master/src/assets/fonts](https://github.com/AAHub/fontbook/tree/master/src/assets/fonts)<br>**手順:** 上記URLのリストより **Saitamaar.ttf** または **Textar.ttf** を入手する。これらはAA表示に特化した代表的フォントであり、タイ文字等の特殊パーツを網羅しているため検証に最適である。選択の根拠：<br>1. **Saitamaar:** AAHubビューアのデフォルトフォント採用の事実上の標準。<br>2. **Textar:** Web環境のAA再現におけるベンチマーク。<br>これらをフォントビューアで開き、タイ文字（U+0E00-）、拡張キリル（U+0400-）、古イタリア文字（U+10300-）等にグリフが定義されていることを確認する。 |
| **3. 数学・論理** | **Unicode Mathematical Operators** | **URL:** [https://www.unicode.org/charts/PDF/U2200.pdf](https://www.unicode.org/charts/PDF/U2200.pdf)<br>**手順:** Unicode公式PDFチャート（U+2200-22FF）に掲載された全図形がJa16に存在することを確認する。 |
| **4. 手順書・UI** | **Unicode Miscellaneous Technical** | **URL:** [https://www.unicode.org/charts/PDF/U2300.pdf](https://www.unicode.org/charts/PDF/U2300.pdf)<br>**手順:** Unicode公式PDFチャート（U+2300-23FF）に掲載された全図形がJa16に存在することを確認する。 |
| **5. 囲み文字** | **Unicode Enclosed Alphanumerics** | **URL:** [https://www.unicode.org/charts/PDF/U2460.pdf](https://www.unicode.org/charts/PDF/U2460.pdf)<br>**手順:** Unicode公式PDFチャート（U+2460-24FF）に掲載された全図形がJa16に存在することを確認する。 |

### 2.4.1 IPA漢字領域の網羅性保証 (Coverage Assurance: IPA Kanji)
| 対象カテゴリ | 検証用ソース | 具体的検証手順 |
| :--- | :--- | :--- |
| **日本語表現(漢字)** | **IPA 文字情報基盤 (MJ文字)** | **URL:** [https://moji.or.jp/mojikiban/mj/mjlist/](https://moji.or.jp/mojikiban/mj/mjlist/)<br>**手順:** 同サイトから **mji.00602.xlsx** をダウンロード。ファイル内の「MJ文字図形名（MJ000001〜MJ058862）」がJa16のインデックス（0x1A12以降）と完全一致することを確認する。 |

---

## 3. プロジェクト運用プロトコル (Operational Protocol)
1. **一字一符号の原則:** 文字と符号を1対1で対応させ、結合文字を徹底的に排除する。
2. **要約・省略の禁止:** 確定済みの順序、存在意義、検証用ソース等の情報を「要約」として削減することを厳禁とする。
3. **変更承認制:** 既存の全記述（存在意義、要件、仕様）の変更・削除には、必ず理由を添えた提案(RFC)と承認を必須とする。
4. **セマンティック・アンカーの維持:** AIの解釈精度維持のため英語併記を継続する。